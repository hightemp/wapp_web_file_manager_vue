(function(){"use strict";var e={29:function(e,t,i){var a=i(963),s=i(252),n=i(577);const l={class:"wrapper"},o={class:"blocker"},r={class:"account-panel"},c={class:"account-control-panel"},d=(0,s._)("input",{type:"text",class:"form-control"},null,-1),u={class:"list-group"},p=["onClick"],b={class:"files-panel"},f={class:"files-control-panel"},h=(0,s._)("i",{class:"bi bi-layout-three-columns"},null,-1),m=[h],w=(0,s._)("i",{class:"bi bi-ui-checks-grid"},null,-1),_=[w],v=(0,s._)("i",{class:"bi bi-ui-checks"},null,-1),g=[v],y={key:0,class:"files-list-as-grid-wrapper"},k={class:"files-grid-control-panel"},C=(0,s._)("i",{class:"bi bi-arrow-left"},null,-1),D=[C],F=(0,s._)("i",{class:"bi bi-arrow-up"},null,-1),P=[F],A=(0,s._)("i",{class:"bi bi-arrow-right"},null,-1),I=[A],R={class:"path"},S={class:"path-wrapper"},T={class:"bi bi-play-fill"},x=["onClick"],O={class:"files-list-wrapper_grid-box-wrapper"},H={class:"files-list-wrapper_grid-box"},L=["onClick"],B={class:"icon-wrapper"},G={class:"icon"},z=(0,s._)("i",{class:"bi bi-folder-fill"},null,-1),W=[z],E={class:"icon"},M=(0,s._)("i",{class:"bi bi-file-earmark-text-fill"},null,-1),N=[M],U={class:"title"},Y={key:1,class:"files-list-as-list-wrapper"},K={class:"files-list-control-panel"},j=(0,s._)("i",{class:"bi bi-arrow-left"},null,-1),q=[j],J=(0,s._)("i",{class:"bi bi-arrow-up"},null,-1),Z=[J],$=(0,s._)("i",{class:"bi bi-arrow-right"},null,-1),V=[$],Q={class:"path"},X={class:"path-wrapper"},ee={class:"bi bi-play-fill"},te=["onClick"],ie={class:"files-list-wrapper_list-box"},ae={class:"files-list-list"},se=(0,s._)("div",{class:"list-row header"},[(0,s._)("div",null,"name"),(0,s._)("div",null,"size"),(0,s._)("div",null,"created at"),(0,s._)("div",null,"modified at")],-1),ne=["onClick"],le={class:"filename-cell"},oe={key:0,class:"icon"},re=(0,s._)("i",{class:"bi bi-folder-fill"},null,-1),ce=[re],de={key:1,class:"icon"},ue=(0,s._)("i",{class:"bi bi-file-earmark-text-fill"},null,-1),pe=[ue],be={class:"title"},fe={key:2,class:"files-list-wrapper"},he={class:"files-list-wrapper_box"},me=["onClick"],we={class:"icon"},_e=(0,s._)("i",{class:"bi bi-folder-fill"},null,-1),ve=[_e],ge={class:"icon"},ye=(0,s._)("i",{class:"bi bi-file-earmark-text-fill"},null,-1),ke=[ye],Ce={class:"page-preview"},De={class:"code-preview"},Fe={class:"image-preview"},Pe={class:"loader"},Ae=(0,s._)("div",{class:"center"},[(0,s._)("div",{class:"lds-dual-ring"})],-1),Ie=[Ae];function Re(e,t,i,h,w,v){const C=(0,s.up)("Dropdown");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",l,[(0,s.wy)((0,s._)("div",o,null,512),[[a.F8,null===w.iActiveRepo]]),(0,s._)("div",r,[(0,s._)("div",c,[d,(0,s.Wm)(C)]),(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aRepos,((e,t)=>((0,s.wg)(),(0,s.iD)("button",{key:e,type:"button",class:(0,n.C_)("list-group-item list-group-item-action "+(w.iActiveRepo==t?"active":"")),"aria-current":"true",onClick:i=>v.fnSlectRepo(t,e)},(0,n.zw)(e.name),11,p)))),128))])]),(0,s._)("div",b,[(0,s._)("div",f,[(0,s._)("button",{class:(0,n.C_)("btn "+("column"==w.sFilesListType?"btn-primary":"")),onClick:t[0]||(t[0]=e=>w.sFilesListType="column")},m,2),(0,s._)("button",{class:(0,n.C_)("btn "+("grid"==w.sFilesListType?"btn-primary":"")),onClick:t[1]||(t[1]=e=>w.sFilesListType="grid")},_,2),(0,s._)("button",{class:(0,n.C_)("btn "+("list"==w.sFilesListType?"btn-primary":"")),onClick:t[2]||(t[2]=e=>w.sFilesListType="list")},g,2)]),"grid"==w.sFilesListType?((0,s.wg)(),(0,s.iD)("div",y,[(0,s._)("div",k,[(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[3]||(t[3]=(...t)=>e.fnGoPrev&&e.fnGoPrev(...t))},D),(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[4]||(t[4]=(...e)=>v.fnGoUp&&v.fnGoUp(...e))},P),(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[5]||(t[5]=(...t)=>e.fnGoNext&&e.fnGoNext(...t))},I),(0,s._)("div",R,[(0,s._)("div",S,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aPath,((e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:e},[(0,s.wy)((0,s._)("i",T,null,512),[[a.F8,t>0]]),(0,s._)("div",{class:"path-link",onClick:e=>v.fnOpenPathByIndex(t)},(0,n.zw)(e),9,x)],64)))),128))])])]),(0,s._)("div",O,[(0,s._)("div",H,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aFiles,(e=>((0,s.wg)(),(0,s.iD)("button",{key:e,type:"button",class:"list-group-item list-group-item-action file-grid-item","aria-current":"true",onClick:t=>v.fnClickFileItem(e)},[(0,s._)("div",B,[(0,s.wy)((0,s._)("span",G,W,512),[[a.F8,"directory"==e.type]]),(0,s.wy)((0,s._)("span",E,N,512),[[a.F8,"file"==e.type]])]),(0,s._)("div",U,(0,n.zw)(e.name),1)],8,L)))),128))])])])):(0,s.kq)("",!0),"list"==w.sFilesListType?((0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("div",K,[(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[6]||(t[6]=(...t)=>e.fnGoPrev&&e.fnGoPrev(...t))},q),(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[7]||(t[7]=(...e)=>v.fnGoUp&&v.fnGoUp(...e))},Z),(0,s._)("button",{class:(0,n.C_)("btn "),onClick:t[8]||(t[8]=(...t)=>e.fnGoNext&&e.fnGoNext(...t))},V),(0,s._)("div",Q,[(0,s._)("div",X,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aPath,((e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:e},[(0,s.wy)((0,s._)("i",ee,null,512),[[a.F8,t>0]]),(0,s._)("div",{class:"path-link",onClick:e=>v.fnOpenPathByIndex(t)},(0,n.zw)(e),9,te)],64)))),128))])])]),(0,s._)("div",ie,[(0,s._)("div",ae,[se,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aFiles,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"list-row",onClick:t=>v.fnClickFileItem(e)},[(0,s._)("div",le,["directory"==e.type?((0,s.wg)(),(0,s.iD)("span",oe,ce)):(0,s.kq)("",!0),"file"==e.type?((0,s.wg)(),(0,s.iD)("span",de,pe)):(0,s.kq)("",!0),(0,s._)("div",be,(0,n.zw)(e.name),1)]),(0,s._)("div",null,(0,n.zw)(e.human_size),1),(0,s._)("div",null,(0,n.zw)(e.created_at),1),(0,s._)("div",null,(0,n.zw)(e.updated_at),1)],8,ne)))),128))])])])):(0,s.kq)("",!0),"column"==w.sFilesListType?((0,s.wg)(),(0,s.iD)("div",fe,[(0,s._)("div",he,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.aFilesColumns,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"list-group files-list"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e,(e=>((0,s.wg)(),(0,s.iD)("button",{key:e,type:"button",class:(0,n.C_)("list-group-item list-group-item-action file-item "+(e.name==w.aPath[t+1]?"active":"")),onClick:i=>v.fnClickFileItem(e,t)},[(0,s.wy)((0,s._)("span",we,ve,512),[[a.F8,"directory"==e.type]]),(0,s.wy)((0,s._)("span",ge,ke,512),[[a.F8,"file"==e.type]]),(0,s.Uk)(" "+(0,n.zw)(e.name),1)],10,me)))),128))])))),128))])])):(0,s.kq)("",!0)]),(0,s._)("div",Ce,[(0,s.wy)((0,s._)("div",De,null,512),[[a.F8,"code"==w.sPreviewShow]]),(0,s.wy)((0,s._)("div",Fe,null,512),[[a.F8,"image"==w.sPreviewShow]])])]),(0,s.wy)((0,s._)("div",Pe,Ie,512),[[a.F8,w.bShowLoader]])],64)}var Se=i(473),Te=i(478),xe=i(207),Oe=i(279),He=i.n(Oe);const Le=new(He());function Be(e,t=!0,i=1){const a=t?1e3:1024;if(Math.abs(e)<a)return e+" B";const s=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let n=-1;const l=10**i;do{e/=a,++n}while(Math.round(Math.abs(e)*l)/l>=a&&n<s.length-1);return e.toFixed(i)+" "+s[n]}class Ge{static oDatabase={groups_last_id:0,groups:[],categories_last_id:0,categories:[],articles_last_id:0,articles:[],favorites_last_id:0,favorites:[],tags_last_id:0,tags:[],tags_relations_last_id:0,tags_relations:[],links_last_id:0,links:[]};static octokit=null;static SHA="";static webdav=null;static oRepoItem=null;static DATABASE_PATH="notes-database.json";static DATABASE_UPDATE_TIMEOUT=3e4;static fnInit(e){Ge.oRepoItem=e,"github"==e.type&&Ge.fnInitGit(),"webdav"==e.type&&Ge.fnInitWebdav()}static fnInitGit(){Ge.octokit=new Se.v({auth:Ge.oRepoItem.key})}static fnInitWebdav(){Ge.webdav=(0,Te.createClient)(Ge.oRepoItem.url,{username:Ge.oRepoItem.username,password:Ge.oRepoItem.password})}static fnFirstLoadDatabase(){_s("Database.fnFirstLoadDatabase")}static fnList(e){return"github"==Ge.oRepoItem.type?Ge.fnListGithub(e):"webdav"==Ge.oRepoItem.type?Ge.fnListWebdav(e):void 0}static fnReadFile(e){return"github"==Ge.oRepoItem.type?Ge.fnReadDatabaseGithub():"webdav"==Ge.oRepoItem.type?Ge.fnReadDatabaseWebdav():void 0}static fnWriteFile(e,t){return"github"==Ge.oRepoItem.type?Ge.fnWriteDatabaseGithub():"webdav"==Ge.oRepoItem.type?Ge.fnWriteDatabaseWebdav():void 0}static fnGetSHADatabase(){return new Promise(((e,t)=>{Database.SHA||Database.octokit.rest.repos.getContent({owner:Database.sLogin,repo:Database.sRepo,path:Database.DATABASE_PATH}).then((({data:t})=>{Database.SHA=t.sha,e(Database.SHA),Le.emit("database-get-sha-success")})).catch((e=>{t(e),Le.emit("database-get-sha-error")}))}))}static fnListGithub(e){var t=Ge.oRepoItem;return new Promise((async(i,a)=>{try{var s=await Ge.octokit.rest.repos.getContent({owner:t.login,repo:t.repo,path:e});i(s)}catch(n){a(n)}}))}static fnListWebdav(e){Ge.oRepoItem;return new Promise((async(t,i)=>{try{var a=await Ge.webdav.getDirectoryContents(e);"/"!=e&&(a=a.splice(1)),a=a.map((e=>({name:e.basename,type:e.type,size:e.size,human_size:Be(e.size),updated_at:new Date(e.lastmod).toLocaleString("ru-RU")}))),t(a)}catch(s){i(s)}}))}static fnReadDatabaseWebdav(){Ge.oRepoItem;return new Promise((async(e,t)=>{try{var i=await Ge.webdav.getFileContents(Ge.DATABASE_PATH),a=new TextDecoder("utf-8"),s=a.decode(i);_l("fnReadDatabaseWebdav",s),Ge.oDatabase=JSON.parse(s),e(Ge.oDatabase)}catch(n){_l(n),Le.emit("database-db-error",n+""),/Not Found/.test(n+"")?(Le.emit("database-db-load-error-notfound",n+""),Le.emit("database-db-save")):Le.emit("database-db-load-error-github-exception",n+"")}}))}static fnReadDatabaseGithub(){var e=Ge.oRepoItem;return Ge.octokit.rest.repos.getContent({owner:e.login,repo:e.repo,path:Ge.DATABASE_PATH}).then((({data:e})=>(_l("fnGetNotesDatabase",e),Ge.oDatabase=JSON.parse((0,xe.Jx)(e.content)),Ge.SHA=e.sha,Le.emit("database-db-loaded"),Ge.oDatabase))).catch(((...e)=>{Le.emit("database-db-error",aArgs[0]+""),/Not Found/.test(e[0])?(Le.emit("database-db-load-error-notfound",aArgs[0]+""),Le.emit("database-db-save")):Le.emit("database-db-load-error-github-exception",aArgs[0]+"")}))}static fnWriteDatabaseGithub(){_s("Database.fnWriteNotesDatabase");var e=JSON.stringify(Ge.oDatabase,null,4),t=Ge.oRepoItem;return Ge.octokit.rest.repos.createOrUpdateFileContents({owner:t.sLogin,repo:t.sRepo,path:Ge.DATABASE_PATH,sha:Ge.SHA,message:Ge.fnGetUpdateMessage(),content:(0,xe.cv)(e)}).then((()=>{Le.emit("database-db-saved")})).catch(((...e)=>{Le.emit("database-db-error",e[0]+""),Le.emit("database-db-save-error",e[0]+"")}))}static fnWriteDatabaseWebdav(){var e=JSON.stringify(Ge.oDatabase,null,4);Ge.oRepoItem;return new Promise((async(t,i)=>{try{var a=new TextEncoder,s=a.encode(e);await Ge.webdav.putFileContents(Ge.DATABASE_PATH,s,{contentLength:!1,overwrite:!0}),Le.emit("database-db-saved")}catch(n){throw Le.emit("database-db-error",n+""),Le.emit("database-db-save-error",n+""),/Not Found/.test(n+"")?(Le.emit("database-db-load-error-notfound",n+""),Le.emit("database-db-save")):Le.emit("database-db-load-error-github-exception",n+""),n}}))}static fnGetUpdateMessage(){return"update: "+new Date}static fnUpdateNoteDatabase(){}}const ze={class:"dropdown"},We=["onClick","innerHTML"];function Ee(e,t,i,a,l,o){return(0,s.wg)(),(0,s.iD)("div",ze,[(0,s._)("a",{class:"btn dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:t[0]||(t[0]=(...e)=>o.fnMenuOpen&&o.fnMenuOpen(...e))}),(0,s._)("ul",{class:(0,n.C_)("dropdown-menu "+(l.bOpened?"show":""))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.aItems,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id},[(0,s._)("a",{class:"dropdown-item",href:"#",onClick:t=>o.fnOnItemClick(e),innerHTML:e.title},null,8,We)])))),128))],2)])}var Me={props:["items"],emits:["clickitem"],data(){return{aItems:this.items,bOpened:!1}},methods:{fnFocusOut(){this.bOpened=!1},fnMenuOpen(){this.bOpened=!this.bOpened},fnOnItemClick(e){this.bOpened=!1,this.$emit("clickitem",e)}},created(){window.addEventListener("click",(e=>{this.$el.contains(e.target)||(this.bOpened=!1)}))}},Ne=i(744);const Ue=(0,Ne.Z)(Me,[["render",Ee]]);var Ye=Ue;const Ke=["onClick"],je={class:"icon"},qe=(0,s._)("i",{class:"bi bi-folder-fill"},null,-1),Je=[qe],Ze={class:"icon"},$e=(0,s._)("i",{class:"bi bi-file-earmark-text-fill"},null,-1),Ve=[$e];function Qe(e,t,i,l,o,r){return(0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.aFiles,(e=>((0,s.wg)(),(0,s.iD)("button",{key:e,type:"button",class:(0,n.C_)("list-group-item list-group-item-action file-item"+(e.name==r.sSelectedDir?"active":"")),onClick:t=>r.fnItemClick(e,r.iColumnIndex)},[(0,s.wy)((0,s._)("span",je,Je,512),[[a.F8,"directory"==e.type]]),(0,s.wy)((0,s._)("span",Ze,Ve,512),[[a.F8,"file"==e.type]]),(0,s.Uk)(" "+(0,n.zw)(e.name),1)],10,Ke)))),128)}var Xe={name:"TestFiles",emits:["clickitem"],props:["files","columnindex","selecteddir"],methods:{fnItemClick(e){this.$emit("clickitem",e)}},computed:{aFiles(){return this.files},iColumnIndex(){return this.columnindex},sSelectedDir(){return this.selecteddir}}};const et=(0,Ne.Z)(Xe,[["render",Qe]]);var tt=et,it=[{name:"webdav - demo",type:"webdav",url:"http://minicomp-04.local/webdav",login:"",repo:"",key:""},{name:"github - demo",type:"github",url:"",login:"hightemp",repo:"hightemp",key:"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"}],at={name:"App",components:{FilesColumnList:tt,Dropdown:Ye},methods:{fnSlectRepo(e,t){this.iActiveRepo=e,Ge.fnInit(t),this.fnResetPath(),this.fnSelectPath("/")},fnResetPath(){this.aFiles=[],this.aFilesColumns=[]},fnSelectPath(e){this.aPath.push(e),this.bShowLoader=!0,Ge.fnList("/"+this.aPath.join("/")).then((e=>{this.aFiles=e,this.aFilesColumns.push(e),this.bShowLoader=!1,console.log(e)}))},fnClickFileItem(e,t){console.log(">>",[t,this.aFilesColumns.length]),void 0!==t&&t<this.aFilesColumns.length-1&&(this.aFilesColumns.splice(t+1),this.aPath.splice(t+1)),"directory"==e.type&&this.fnSelectPath(e.name)},fnGoUp(){if(1!=this.aPath.length){var e=this.aFilesColumns.length-1,t=this.aPath[this.aPath.length-2];this.aFilesColumns.splice(e-1),this.aPath.splice(e-1),console.log([t,e-1,this.aFilesColumns,this.aPath]),this.fnSelectPath(t)}},fnOpenPathByIndex(e){var t=this.aPath[e];this.aFilesColumns.splice(e),this.aPath.splice(e),console.log([t,this.aFilesColumns,this.aPath]),this.fnSelectPath(t)}},data(){return{bShowLoader:!1,bShowBlocker:!1,sFilesListType:"column",sPreviewShow:"code",sSelectedFilePath:"",iGridPage:0,aMenu:[],aPathHistory:[],iActiveRepo:null,aRepos:it,aPath:[],aFiles:[],aFilesColumns:[]}},created(){}};const st=(0,Ne.Z)(at,[["render",Re]]);var nt=st;(0,a.ri)(nt).mount("#app")}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,a,s,n){if(!a){var l=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],n=e[d][2];for(var o=!0,r=0;r<a.length;r++)(!1&n||l>=n)&&Object.keys(i.O).every((function(e){return i.O[e](a[r])}))?a.splice(r--,1):(o=!1,n<l&&(l=n));if(o){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,s,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,n,l=a[0],o=a[1],r=a[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(r)var d=r(i)}for(t&&t(a);c<l.length;c++)n=l[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},a=self["webpackChunkwapp_web_file_manager_vue"]=self["webpackChunkwapp_web_file_manager_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(29)}));a=i.O(a)})();
//# sourceMappingURL=app.1d5cdc9e.js.map